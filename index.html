<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  <!-- iOS fullscreen web app support -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="OneLess">

  <title>OneLess Vending Machine</title>
  <style>
    :root{
      --green:#20543c;
      --bg:#000;
      --card:#fff;
      --text:#111;
      --muted:#444;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
      background:var(--bg);
      height:100vh;
      display:grid;
      place-items:center;
    }

    .vending-container{
      width: 812px;
      height: 375px;
      background: var(--green);
      border-radius:24px;
      padding: 16px;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .screen,.welcome-screen{
      width: 100%;
      height: 100%;
      background: var(--card);
      color: var(--text);
      border-radius: 16px;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      text-align:center;
    }
    .welcome-screen{cursor:pointer;font-weight:700;font-size:28px}

    h2{margin:0 0 16px 0;font-size:24px}
    p{margin:8px 0 0 0;font-size:18px;color:var(--muted)}

    .btn, .keypad button{
      appearance:none;
      border:0;
      background: var(--green);
      color:#fff;
      font-weight:700;
      border-radius:10px;
      height: 52px;
      font-size:18px;
      cursor:pointer;
    }
    .btn-secondary{ background:#18402d }

    .product-buttons button,
    .payment-buttons button{
      width: 180px;
      height: 70px;
      font-size:22px;
      border-radius:14px;
    }

    .amount-display{
      font-size:48px;
      font-weight:800;
      margin-top:10px;
    }

    .price-hint{
      font-size:18px;
      color:var(--muted);
      margin-top:4px;
    }

    .split{
      display:flex;
      justify-content:space-between;
      align-items:center;
      width:100%;
      height:100%;
      gap:30px;
      padding: 20px;
    }
    .split-left,.split-right{
      flex:1;
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      text-align:center;
    }

    .keypad{
      display:grid;
      grid-template-columns: repeat(3, 90px);
      gap:12px;
    }
    .keypad button{ height:60px; font-size:20px; font-weight:700 }

    .progress{
      width: 80%;
      max-width: 520px;
      height: 18px;
      background: #e9ecef;
      border-radius: 999px;
      overflow:hidden;
      margin-top: 14px;
      border:1px solid #d6d6d6;
    }
    .progress-bar{
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #20543c, #18402d);
      transition: width .2s ease;
    }
    .progress-label{ margin-top:8px; font-weight:700; color:var(--muted) }

    .final h2{ font-size:32px; margin-bottom:12px }
    .final p{ font-size:20px; line-height:1.4 }
  </style>
</head>
<body>
  <div class="vending-container">
    <div class="welcome-screen" id="welcome" onclick="startMachine()">
      Welcome<br/>Tap to Continue
    </div>
    <div class="screen" id="screen" style="display:none;"></div>
  </div>

  <script>
    let inputAmount = "";
    let productType = "";
    let paymentMethod = "";

    function startMachine(){
      document.getElementById('welcome').style.display='none';
      const s=document.getElementById('screen');
      s.style.display='flex';
      resetMachine();
    }

    function resetMachine(){
      inputAmount=""; productType=""; paymentMethod="";
      const s=document.getElementById('screen');
      s.innerHTML =
        '<h2>Select Product</h2>' +
        '<div class="product-buttons" style="display:flex; gap:20px; margin-top:20px;">' +
          '<button class="btn" onclick="selectProduct(\'Shampoo\')">Shampoo</button>' +
          '<button class="btn" onclick="selectProduct(\'Body Wash\')">Body Wash</button>' +
        '</div>';
    }

    function selectProduct(type){
      productType = type;
      showAmountInput();
    }

    function showAmountInput(){
      const s=document.getElementById('screen');
      s.innerHTML =
        '<div class="split">' +
          '<div class="split-left">' +
            '<h2>Enter Amount (L)</h2>' +
            '<div class="price-hint">Price: NZ$5 per litre</div>' +
            '<div class="amount-display" id="amount">0</div>' +
          '</div>' +
          '<div class="split-right">' +
            '<div class="keypad">' +
              '<button onclick="appendNumber(\'1\')">1</button>' +
              '<button onclick="appendNumber(\'2\')">2</button>' +
              '<button onclick="appendNumber(\'3\')">3</button>' +
              '<button onclick="appendNumber(\'4\')">4</button>' +
              '<button onclick="appendNumber(\'5\')">5</button>' +
              '<button onclick="appendNumber(\'6\')">6</button>' +
              '<button onclick="appendNumber(\'7\')">7</button>' +
              '<button onclick="appendNumber(\'8\')">8</button>' +
              '<button onclick="appendNumber(\'9\')">9</button>' +
              '<button onclick="deleteNumber()">Del</button>' +
              '<button onclick="appendNumber(\'0\')">0</button>' +
              '<button class="btn-secondary" onclick="showPrice()">Next</button>' +
            '</div>' +
          '</div>' +
        '</div>';
    }

    function appendNumber(n){
      if(inputAmount.length < 3){
        inputAmount += n;
        document.getElementById('amount').textContent = inputAmount;
      }
    }

    function deleteNumber(){
      inputAmount = inputAmount.slice(0,-1);
      document.getElementById('amount').textContent = inputAmount || "0";
    }

    function showPrice(){
      if(inputAmount === "") { alert("Enter amount first."); return; }
      const price = (parseInt(inputAmount,10) || 0) * 5;
      const s=document.getElementById('screen');
      s.innerHTML =
        '<div class="split">' +
          '<div class="split-left">' +
            '<h2>Price Summary</h2>' +
          '</div>' +
          '<div class="split-right" style="gap:16px;">' +
            '<p><strong>' + inputAmount + ' L</strong> of <strong>' + productType + '</strong></p>' +
            '<p>Total: <strong>NZ$ ' + price + '</strong></p>' +
            '<button class="btn" onclick="goToPayment()">Continue to Payment</button>' +
          '</div>' +
        '</div>';
    }

    function goToPayment(){
      const s=document.getElementById('screen');
      s.innerHTML =
        '<div class="split">' +
          '<div class="split-left">' +
            '<h2>Select Payment</h2>' +
          '</div>' +
          '<div class="split-right payment-buttons" style="gap:20px;">' +
            '<button class="btn" onclick="selectPayment(\'Debit/Credit Card\')">Debit/Credit Card</button>' +
            '<button class="btn" onclick="selectPayment(\'Mobile Payment\')">Mobile Payment</button>' +
          '</div>' +
        '</div>';
    }

    function selectPayment(method){
      paymentMethod = method;
      showConfirmation();
    }

    function showConfirmation(){
      const price = (parseInt(inputAmount,10) || 0) * 5;
      const s=document.getElementById('screen');
      s.innerHTML =
        '<div class="split">' +
          '<div class="split-left">' +
            '<h2>Confirm Order</h2>' +
          '</div>' +
          '<div class="split-right" style="gap:16px;">' +
            '<p><strong>' + inputAmount + ' L</strong> of <strong>' + productType + '</strong></p>' +
            '<p>Price: <strong>NZ$ ' + price + '</strong></p>' +
            '<p>Payment: <strong>' + paymentMethod + '</strong></p>' +
            '<button class="btn" onclick="startRefill()">Confirm &amp; Refill</button>' +
          '</div>' +
        '</div>';
    }

    function startRefill(){
      const s=document.getElementById('screen');
      s.innerHTML =
        '<h2>Refillingâ€¦</h2>' +
        '<div class="progress"><div class="progress-bar" id="bar"></div></div>' +
        '<div class="progress-label" id="pct">0%</div>' +
        '<p>Hold your bottle steady.</p>';

      let pct = 0;
      const bar = document.getElementById('bar');
      const label = document.getElementById('pct');

      const t = setInterval(()=>{
        pct += 5;
        if(pct > 100) pct = 100;
        bar.style.width = pct + "%";
        label.textContent = pct + "%";
        if(pct === 100){
          clearInterval(t);
          setTimeout(showThankYou, 300);
        }
      }, 150);
    }

    function showThankYou(){
      const s=document.getElementById('screen');
      s.classList.add('final');
      s.innerHTML =
        '<div class="split">' +
          '<div class="split-left">' +
            '<h2>ðŸŽ‰ Nice work!</h2>' +
            '<p>You just avoided <strong>1 plastic bottle</strong><br/>and about <strong>0.12 kg COâ‚‚e</strong>.</p>' +
          '</div>' +
          '<div class="split-right">' +
            '<button class="btn" onclick="startMachine()">Back to Main Menu</button>' +
          '</div>' +
        '</div>';
    }
  </script>
</body>
</html>
